Loading model...

Initializing GradCAM...
Target Layer: conv5_block3_out
Nested Model: resnet50v2

Generating Heatmap...
Constructing grad_model with inputs=[<KerasTensor shape=(None, 224, 224, 3), dtype=float32, sparse=False, ragged=False, name=input_layer_1>] and outputs=[<KerasTensor shape=(None, 7, 7, 2048), dtype=float32, sparse=False, ragged=False, name=keras_tensor_389>, [<KerasTensor shape=(None, 5), dtype=float32, sparse=False, ragged=False, name=keras_tensor_417>]]
C:\Users\rathi\OneDrive\Desktop\Gravity Thesis\venv\Lib\site-packages\keras\src\models\functional.py:241: UserWarning: The structure of `inputs` doesn't match the expected structure.
Expected: ['input_layer_1']
Received: inputs=Tensor(shape=(1, 224, 224, 3))
  warnings.warn(msg)
ERROR: "Exception encountered when calling Functional.call().\n\n\x1b[1m1642118604560\x1b[0m\n\nArguments received by Functional.call():\n  • inputs=array([[[[ 0.16305554, -0.8177777 , -0.7151737 ],\n         [ 0.6253351 , -0.42757583,  0.9218826 ],\n         [-0.9295255 ,  0.1835388 , -0.7457052 ],\n         ...,\n         [ 0.75810957, -0.24053186,  0.02817285],\n         [ 0.771595  , -0.5772431 ,  0.7745582 ],\n         [-0.4554187 , -0.78929824, -0.8974176 ]],\n\n        [[-0.09004611,  0.95562696,  0.32011425],\n         [-0.9324045 , -0.05767429, -0.25237596],\n         [ 0.23860812, -0.3197533 , -0.34771633],\n         ...,\n         [-0.01622987, -0.39904153, -0.62364566],\n         [-0.84225935, -0.34344095, -0.3864426 ],\n         [ 0.03885686, -0.38749343, -0.5913881 ]],\n\n        [[-0.6057746 ,  0.8218584 ,  0.793617  ],\n         [ 0.63073075, -0.6576354 , -0.8700029 ],\n         [-0.17900759, -0.72721595, -0.7237313 ],\n         ...,\n         [ 0.8551122 ,  0.4382317 , -0.46788245],\n         [-0.38094229, -0.07053667,  0.4762609 ],\n         [ 0.4458958 , -0.5454025 , -0.36032486]],\n\n        ...,\n\n        [[ 0.8658854 , -0.24218994, -0.53996414],\n         [ 0.98684037,  0.42511666, -0.7753235 ],\n         [-0.09538358,  0.99689305, -0.23487246],\n         ...,\n         [-0.7078463 ,  0.99807274, -0.71952224],\n         [-0.16451865, -0.98441106, -0.74688953],\n         [-0.31992233, -0.46672696,  0.99423623]],\n\n        [[ 0.06852746,  0.16022205, -0.3741004 ],\n         [ 0.17397106, -0.5371173 , -0.73028564],\n         [-0.6067329 ,  0.05702245,  0.9204408 ],\n         ...,\n         [-0.82581615,  0.8041476 , -0.6349332 ],\n         [ 0.12122929,  0.00807905,  0.31771743],\n         [-0.30027777, -0.39479512,  0.5907732 ]],\n\n        [[ 0.22786391, -0.872179  , -0.8554538 ],\n         [ 0.31379604, -0.8472243 ,  0.6791742 ],\n         [ 0.11572921,  0.551417  , -0.09154135],\n         ...,\n         [ 0.01745403,  0.15125716,  0.0983479 ],\n         [ 0.01771581,  0.20236492, -0.14702135],\n         [-0.640277  ,  0.82151043, -0.37885255]]]],\n      shape=(1, 224, 224, 3), dtype=float32)\n  • training=None\n  • mask=None\n  • kwargs=<class 'inspect._empty'>"
Traceback (most recent call last):
  File "C:\Users\rathi\OneDrive\Desktop\Gravity Thesis\debug_gradcam.py", line 57, in debug_gradcam
    conv_outputs, predictions = grad_model(img_array)
                                ~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\rathi\OneDrive\Desktop\Gravity Thesis\venv\Lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\rathi\OneDrive\Desktop\Gravity Thesis\venv\Lib\site-packages\keras\src\ops\function.py", line 214, in _run_through_graph
    output_tensors.append(tensor_dict[id(x)])
                          ~~~~~~~~~~~^^^^^^^
KeyError: "Exception encountered when calling Functional.call().\n\n\x1b[1m1642118604560\x1b[0m\n\nArguments received by Functional.call():\n  • inputs=array([[[[ 0.16305554, -0.8177777 , -0.7151737 ],\n         [ 0.6253351 , -0.42757583,  0.9218826 ],\n         [-0.9295255 ,  0.1835388 , -0.7457052 ],\n         ...,\n         [ 0.75810957, -0.24053186,  0.02817285],\n         [ 0.771595  , -0.5772431 ,  0.7745582 ],\n         [-0.4554187 , -0.78929824, -0.8974176 ]],\n\n        [[-0.09004611,  0.95562696,  0.32011425],\n         [-0.9324045 , -0.05767429, -0.25237596],\n         [ 0.23860812, -0.3197533 , -0.34771633],\n         ...,\n         [-0.01622987, -0.39904153, -0.62364566],\n         [-0.84225935, -0.34344095, -0.3864426 ],\n         [ 0.03885686, -0.38749343, -0.5913881 ]],\n\n        [[-0.6057746 ,  0.8218584 ,  0.793617  ],\n         [ 0.63073075, -0.6576354 , -0.8700029 ],\n         [-0.17900759, -0.72721595, -0.7237313 ],\n         ...,\n         [ 0.8551122 ,  0.4382317 , -0.46788245],\n         [-0.38094229, -0.07053667,  0.4762609 ],\n         [ 0.4458958 , -0.5454025 , -0.36032486]],\n\n        ...,\n\n        [[ 0.8658854 , -0.24218994, -0.53996414],\n         [ 0.98684037,  0.42511666, -0.7753235 ],\n         [-0.09538358,  0.99689305, -0.23487246],\n         ...,\n         [-0.7078463 ,  0.99807274, -0.71952224],\n         [-0.16451865, -0.98441106, -0.74688953],\n         [-0.31992233, -0.46672696,  0.99423623]],\n\n        [[ 0.06852746,  0.16022205, -0.3741004 ],\n         [ 0.17397106, -0.5371173 , -0.73028564],\n         [-0.6067329 ,  0.05702245,  0.9204408 ],\n         ...,\n         [-0.82581615,  0.8041476 , -0.6349332 ],\n         [ 0.12122929,  0.00807905,  0.31771743],\n         [-0.30027777, -0.39479512,  0.5907732 ]],\n\n        [[ 0.22786391, -0.872179  , -0.8554538 ],\n         [ 0.31379604, -0.8472243 ,  0.6791742 ],\n         [ 0.11572921,  0.551417  , -0.09154135],\n         ...,\n         [ 0.01745403,  0.15125716,  0.0983479 ],\n         [ 0.01771581,  0.20236492, -0.14702135],\n         [-0.640277  ,  0.82151043, -0.37885255]]]],\n      shape=(1, 224, 224, 3), dtype=float32)\n  • training=None\n  • mask=None\n  • kwargs=<class 'inspect._empty'>"
